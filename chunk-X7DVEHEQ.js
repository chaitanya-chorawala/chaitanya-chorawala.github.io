import{a as p,b as f,c,e as n,g as h,jb as u,k as d,lb as m,m as o,mb as l}from"./chunk-SPT6EKTW.js";var A=(()=>{let a=class a{constructor(e,t,s){this.storage=e,this.afs=t,this.toastr=s}uploadImage(e,t){return this.storage.upload(t,e).then(()=>f(this.storage.ref(t).getDownloadURL()))}updateImage(e,t){return console.log("### Update image: ",e,t),this.storage.refFromURL(t).put(e).snapshotChanges()}deleteImage(e){return this.storage.refFromURL(e).delete()}savePost(e){return n(()=>this.afs.collection("posts").add(e))}updatePost(e,t){return n(()=>this.afs.doc(`posts/${e}`).update(t))}deletePost(e){return n(()=>this.afs.doc(`posts/${e}`).delete())}addData(e,t){let s=`postImg/${Date.now()}`;this.uploadImage(e,s).then(i=>{t.imagePath=i,this.savePost(t).subscribe(()=>this.toastr.success("Post saved successfully!","Success"))})}updateData(e,t,s){if(console.log("###Update data: ",e,t,s),typeof e=="string"){this.updatePost(s,t).subscribe(()=>this.toastr.success("Post changed successfully!","Success"));return}this.updateImage(e,t.imagePath).subscribe(()=>{this.updatePost(s,t).subscribe(()=>this.toastr.success("Post changed successfully!","Success"))})}updateFeature(e,t){let s={isFeatured:t};this.updatePost(e,s).subscribe(()=>this.toastr.success("Featured changed successfully!","Success"))}saveData(e,t,s,i){switch(console.log("### Save data: ",s),s){case"Add":this.addData(e,t);break;case"Edit":this.updateData(e,t,i);break;default:break}}deleteData(e,t){this.deleteImage(t).subscribe(()=>{this.deletePost(e).subscribe(()=>this.toastr.success("Post deleted successfully!","Success"))})}loadData(){return this.afs.collection("posts").snapshotChanges().pipe(c(e=>e.map(t=>{let s=t.payload.doc.data();return s.createdAt=s.createdAt?new Date(s.createdAt?.toMillis()):null,{id:t.payload.doc.id,data:s}})))}loadById(e){return this.afs.doc(`posts/${e}`).valueChanges().pipe(c(t=>{let s=t;return s.createdAt=s.createdAt?new Date(s.createdAt?.toMillis()):null,s}))}loadByCategoryId(e){return this.afs.collection("posts",t=>t.where("category.id","==",e)).snapshotChanges().pipe(c(t=>t.map(s=>{let i=s.payload.doc.data();return i.createdAt=i.createdAt?new Date(i.createdAt?.toMillis()):null,{id:s.payload.doc.id,data:i}})))}};a.\u0275fac=function(t){return new(t||a)(o(m),o(l),o(u))},a.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"});let r=a;return r})();var j=(()=>{let a=class a{constructor(e,t){this.afs=e,this.toastr=t}doContactUs(e){p(this.afs.collection("contactus").add(e)).pipe(h(t=>"Something went wrong!")).subscribe({next:t=>this.toastr.success("Message submitted!","Success"),error:t=>this.toastr.error(t,"Error")})}loadData(){return this.afs.collection("contactus").snapshotChanges().pipe(c(e=>e.map(t=>({id:t.payload.doc.id,data:t.payload.doc.data()}))))}deleteMessage(e){p(this.afs.doc(`contactus/${e}`).delete()).pipe(h(t=>"Something went wrong!")).subscribe({next:t=>this.toastr.success("Message delete successfully!"),error:t=>this.toastr.error(t,"Error")})}};a.\u0275fac=function(t){return new(t||a)(o(l),o(u))},a.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"});let r=a;return r})();var C=(()=>{let a=class a{constructor(e,t){this.afs=e,this.toastr=t}doSubscribe(e){return n(()=>this.afs.collection("subscription").add(e))}loadData(){return this.afs.collection("subscription").snapshotChanges().pipe(c(e=>e.map(t=>({id:t.payload.doc.id,data:t.payload.doc.data()}))))}deleteSub(e){p(this.afs.doc(`subscription/${e}`).delete()).subscribe({next:t=>this.toastr.success("Subscription deleted successfully!"),error:t=>this.toastr.success(t,"Error")})}};a.\u0275fac=function(t){return new(t||a)(o(l),o(u))},a.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"});let r=a;return r})();export{A as a,j as b,C as c};
